<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playora Web - Pusat Jual Beli Website dan Template</title>
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzAwN2JmZiIvPgo8cGF0aCBkPSJNOCAxMmg0djRIOHYtNHptNiAwaDR2NGgtNHYtNHptNiAwaDR2NGgtNHYtNHpNOCAxOGg0djRIOHYtNHptNiAwaDR2NGgtNHYtNHptNiAwaDR2NGgtNHYtNHoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="fontawesome/css/all.min.css">
    <link rel="stylesheet" href="css/templatemo-style.css">
    <!-- Supabase CDN -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <!-- Page Loader - REMOVED -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-film mr-2"></i>
                Playora
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link nav-link-1" href="index.html">Aplikasi</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-2" href="videos.html">Games</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-3 active" aria-current="page" href="web.html">Web</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-4" href="about.html">About</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-5" href="contact.html">Contact</a>
                </li>
                <li class="nav-item" id="adminNavItem" style="display: none;">
                        <a class="nav-link" href="admin.html">
                            <i class="fas fa-shield-alt"></i> Admin
                        </a>
                    </li>
                    <!-- Hidden admin login link -->
                    <li class="nav-item" id="adminLoginItem" style="display: none;">
                        <a class="nav-link" href="login.html" title="Admin Login">
                            <i class="fas fa-key"></i>
                        </a>
                    </li>
            </ul>
            </div>
        </div>
    </nav>

    <div class="tm-hero d-flex justify-content-center align-items-center" data-parallax="scroll" data-image-src="img/hero-game.svg">
        <form class="d-flex tm-search-form" id="searchForm">
            <input class="form-control tm-search-input" type="search" placeholder="Cari website atau template..." aria-label="Search" id="searchInput">
            <button class="btn btn-outline-success tm-search-btn" type="submit">
                <i class="fas fa-search"></i>
            </button>
        </form>
    </div>

    <div class="container-fluid tm-container-content tm-mt-60">
        <div class="row mb-4">
            <h2 class="col-6 tm-text-primary">
                <span id="pageTitle">Latest Website & Template</span>
            </h2>
            <div class="col-6 d-flex justify-content-end align-items-center">
                <div class="tm-text-primary">
                    <select id="categoryFilter" class="form-select tm-input-paging tm-text-primary" style="display: inline-block; width: auto; margin-right: 10px;">
                        <option value="all">Semua</option>
                        <option value="website">Website</option>
                        <option value="template">Template</option>
                    </select>
                    <span id="paginationInfo">Loading...</span>
                </div>
            </div>
        </div>
        <!-- Loading indicator - REMOVED -->
        
        <!-- Web items container -->
        <div class="row tm-mb-90 tm-gallery" id="webContainer">
            <!-- Data akan dimuat dari database -->
        </div>
        
        <!-- No results message -->
        <div id="noResultsMessage" class="row" style="display: none;">
            <div class="col-12 text-center">
                <h4 class="tm-text-primary">Tidak ada hasil ditemukan</h4>
                <p class="tm-text-gray">Coba ubah kata kunci pencarian atau filter kategori.</p>
            </div>
        </div>
        
        <!-- Pagination -->
        <div class="row tm-mb-90">
            <div class="col-12 d-flex justify-content-between align-items-center">
                <button id="prevBtn" class="btn btn-primary tm-btn-big" disabled>
                    <i class="fas fa-chevron-left"></i> Previous
                </button>
                <span id="pageInfo" class="tm-text-primary">Page 1 of 1</span>
                <button id="nextBtn" class="btn btn-primary tm-btn-big" disabled>
                    Next <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <div class="container-fluid tm-bg-gray tm-text-gray tm-footer">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-12 px-5 tm-footer-content">
                <ul class="tm-footer-links pl-0">
                    <li><a href="#">FAQ</a></li>
                    <li><a href="#">Contact</a></li>
                    <li><a href="#">Support</a></li>
                    <li><a href="#">Privacy</a></li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-12 px-5 tm-footer-content">
                <p class="mb-0 mt-2 tm-text-gray">Copyright &copy; 2024 Playora App Store</p>
            </div>
        </div>
    </div>

    <script src="js/plugins.js"></script>
    <script src="js/database.js"></script>
    <script>
        // Web page specific functionality
        let currentPage = 1;
        const itemsPerPage = 12;
        let allWebItems = [];
        let filteredWebItems = [];
        let currentFilter = 'all';
        let currentSearch = '';

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            loadWebItems();
            setupEventListeners();
        });

        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchForm').addEventListener('submit', function(e) {
                e.preventDefault();
                currentSearch = document.getElementById('searchInput').value.toLowerCase();
                currentPage = 1;
                filterAndDisplayWebItems();
            });

            // Category filter
            document.getElementById('categoryFilter').addEventListener('change', function() {
                currentFilter = this.value;
                currentPage = 1;
                filterAndDisplayWebItems();
            });

            // Pagination
            document.getElementById('prevBtn').addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    displayWebItems();
                }
            });

            document.getElementById('nextBtn').addEventListener('click', function() {
                const totalPages = Math.ceil(filteredWebItems.length / itemsPerPage);
                if (currentPage < totalPages) {
                    currentPage++;
                    displayWebItems();
                }
            });
        }

        async function loadWebItems() {
            try {
                // For now, we'll use placeholder data
                // In the future, this will load from Supabase database
                allWebItems = [
                    {
                        id: 1,
                        name: 'E-Commerce Template',
                        category: 'template',
                        price: 'Rp 150.000',
                        image: 'img/img-01.jpg',
                        description: 'Template e-commerce modern dengan fitur lengkap'
                    },
                    {
                        id: 2,
                        name: 'Portfolio Website',
                        category: 'website',
                        price: 'Rp 200.000',
                        image: 'img/img-02.jpg',
                        description: 'Website portfolio profesional untuk freelancer'
                    },
                    {
                        id: 3,
                        name: 'Blog Template',
                        category: 'template',
                        price: 'Rp 100.000',
                        image: 'img/img-03.jpg',
                        description: 'Template blog responsive dengan design modern'
                    }
                ];
                
                filterAndDisplayWebItems();
            } catch (error) {
                console.error('Error loading web items:', error);
                document.getElementById('webContainer').innerHTML = '<div class="col-12 text-center"><p class="tm-text-gray">Error loading web items</p></div>';
            }
        }

        function filterAndDisplayWebItems() {
            filteredWebItems = allWebItems.filter(item => {
                const matchesCategory = currentFilter === 'all' || item.category === currentFilter;
                const matchesSearch = currentSearch === '' || 
                    item.name.toLowerCase().includes(currentSearch) ||
                    item.description.toLowerCase().includes(currentSearch);
                return matchesCategory && matchesSearch;
            });
            
            displayWebItems();
        }

        function displayWebItems() {
            const container = document.getElementById('webContainer');
            const noResultsMessage = document.getElementById('noResultsMessage');
            
            if (filteredWebItems.length === 0) {
                container.innerHTML = '';
                noResultsMessage.style.display = 'block';
                updatePagination(0, 0);
                return;
            }
            
            noResultsMessage.style.display = 'none';
            
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const itemsToShow = filteredWebItems.slice(startIndex, endIndex);
            
            const html = itemsToShow.map(item => `
                <div class="col-xl-3 col-lg-4 col-md-6 col-sm-6 col-12 mb-5">
                    <figure class="effect-ming tm-video-item">
                        <img src="${item.image}" alt="${item.name}" class="img-fluid">
                        <figcaption class="d-flex align-items-center justify-content-center">
                            <h2>${item.name}</h2>
                            <a href="web-detail.html?id=${item.id}">View more</a>
                        </figcaption>
                    </figure>
                    <div class="d-flex justify-content-between tm-text-gray">
                        <span class="tm-text-gray-light">${item.category}</span>
                        <span>${item.price}</span>
                    </div>
                </div>
            `).join('');
            
            container.innerHTML = html;
            updatePagination(filteredWebItems.length, itemsToShow.length);
        }

        function updatePagination(totalItems, currentItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            
            document.getElementById('prevBtn').disabled = currentPage <= 1;
            document.getElementById('nextBtn').disabled = currentPage >= totalPages;
            
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;
            
            const startItem = totalItems > 0 ? (currentPage - 1) * itemsPerPage + 1 : 0;
            const endItem = Math.min(currentPage * itemsPerPage, totalItems);
            document.getElementById('paginationInfo').textContent = `${startItem}-${endItem} of ${totalItems}`;
        }
    </script>
</body>
</html>